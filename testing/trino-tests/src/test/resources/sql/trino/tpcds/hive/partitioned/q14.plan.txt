local exchange (GATHER, SINGLE, [])
    remote exchange (GATHER, SINGLE, [])
        local exchange (GATHER, SINGLE, [])
            local exchange (REPARTITION, ROUND_ROBIN, [])
                final aggregation over (channel_gid, groupid, i_brand_id_gid, i_category_id_gid, i_class_id_gid)
                    local exchange (REPARTITION, HASH, [channel_gid, groupid, i_brand_id_gid, i_category_id_gid, i_class_id_gid])
                        remote exchange (REPARTITION, HASH, [channel_gid, groupid, i_brand_id_gid, i_category_id_gid, i_class_id_gid])
                            partial aggregation over (channel_gid, groupid, i_brand_id_gid, i_category_id_gid, i_class_id_gid)
                                local exchange (REPARTITION, ROUND_ROBIN, [])
                                    cross join:
                                        final aggregation over (i_brand_id_6, i_category_id_8, i_class_id_7)
                                            local exchange (GATHER, SINGLE, [])
                                                remote exchange (REPARTITION, HASH, [i_brand_id_6, i_category_id_8, i_class_id_7])
                                                    intermediate aggregation over (i_brand_id_6, i_category_id_8, i_class_id_7)
                                                        join (INNER, REPLICATED):
                                                            partial aggregation over (ss_item_sk)
                                                                join (INNER, REPLICATED):
                                                                    dynamic filter ([ss_item_sk::bigint], await [ss_sold_date_sk::bigint])
                                                                        scan store_sales
                                                                    local exchange (GATHER, SINGLE, [])
                                                                        remote exchange (REPLICATE, BROADCAST, [])
                                                                            scan date_dim
                                                            local exchange (GATHER, SINGLE, [])
                                                                remote exchange (REPLICATE, BROADCAST, [])
                                                                    join (INNER, PARTITIONED):
                                                                        remote exchange (REPARTITION, HASH, [i_item_sk])
                                                                            dynamic filter ([i_item_sk::bigint])
                                                                                scan item
                                                                        final aggregation over (i_item_sk_15)
                                                                            local exchange (GATHER, SINGLE, [])
                                                                                remote exchange (REPARTITION, HASH, [i_item_sk_15])
                                                                                    partial aggregation over (i_item_sk_15)
                                                                                        join (INNER, PARTITIONED, can skip output duplicates):
                                                                                            remote exchange (REPARTITION, HASH, [i_brand_id_22, i_category_id_26, i_class_id_24])
                                                                                                dynamic filter ([i_brand_id_22::integer, i_category_id_26::integer, i_class_id_24::integer])
                                                                                                    scan item
                                                                                            final aggregation over (brand_id, category_id, class_id)
                                                                                                local exchange (GATHER, SINGLE, [])
                                                                                                    remote exchange (REPARTITION, HASH, [i_brand_id_77, i_category_id_81, i_class_id_79])
                                                                                                        intermediate aggregation over (i_brand_id_77, i_category_id_81, i_class_id_79)
                                                                                                            join (INNER, REPLICATED):
                                                                                                                partial aggregation over (ss_item_sk_44)
                                                                                                                    join (INNER, REPLICATED):
                                                                                                                        dynamic filter ([ss_item_sk_44::bigint], await [ss_sold_date_sk_65::bigint])
                                                                                                                            scan store_sales
                                                                                                                        local exchange (GATHER, SINGLE, [])
                                                                                                                            remote exchange (REPLICATE, BROADCAST, [])
                                                                                                                                scan date_dim
                                                                                                                local exchange (GATHER, SINGLE, [])
                                                                                                                    remote exchange (REPLICATE, BROADCAST, [])
                                                                                                                        scan item
                                                                                                    remote exchange (REPARTITION, HASH, [i_brand_id_137, i_category_id_141, i_class_id_139])
                                                                                                        intermediate aggregation over (i_brand_id_137, i_category_id_141, i_class_id_139)
                                                                                                            join (INNER, REPLICATED):
                                                                                                                partial aggregation over (cs_item_sk)
                                                                                                                    join (INNER, REPLICATED):
                                                                                                                        dynamic filter ([cs_item_sk::bigint], await [cs_sold_date_sk::bigint])
                                                                                                                            scan catalog_sales
                                                                                                                        local exchange (GATHER, SINGLE, [])
                                                                                                                            remote exchange (REPLICATE, BROADCAST, [])
                                                                                                                                scan date_dim
                                                                                                                local exchange (GATHER, SINGLE, [])
                                                                                                                    remote exchange (REPLICATE, BROADCAST, [])
                                                                                                                        scan item
                                                                                                    remote exchange (REPARTITION, HASH, [i_brand_id_197, i_category_id_201, i_class_id_199])
                                                                                                        intermediate aggregation over (i_brand_id_197, i_category_id_201, i_class_id_199)
                                                                                                            join (INNER, REPLICATED):
                                                                                                                partial aggregation over (ws_item_sk)
                                                                                                                    join (INNER, REPLICATED):
                                                                                                                        dynamic filter ([ws_item_sk::bigint], await [ws_sold_date_sk::bigint])
                                                                                                                            scan web_sales
                                                                                                                        local exchange (GATHER, SINGLE, [])
                                                                                                                            remote exchange (REPLICATE, BROADCAST, [])
                                                                                                                                scan date_dim
                                                                                                                local exchange (GATHER, SINGLE, [])
                                                                                                                    remote exchange (REPLICATE, BROADCAST, [])
                                                                                                                        scan item
                                        local exchange (GATHER, SINGLE, [])
                                            remote exchange (REPLICATE, BROADCAST, [])
                                                final aggregation over ()
                                                    local exchange (GATHER, SINGLE, [])
                                                        remote exchange (GATHER, SINGLE, [])
                                                            partial aggregation over ()
                                                                join (INNER, REPLICATED):
                                                                    dynamic filter (await [ss_sold_date_sk_273::bigint])
                                                                        scan store_sales
                                                                    local exchange (GATHER, SINGLE, [])
                                                                        remote exchange (REPLICATE, BROADCAST, [])
                                                                            scan date_dim
                                                            partial aggregation over ()
                                                                join (INNER, REPLICATED):
                                                                    dynamic filter (await [cs_sold_date_sk_342::bigint])
                                                                        scan catalog_sales
                                                                    local exchange (GATHER, SINGLE, [])
                                                                        remote exchange (REPLICATE, BROADCAST, [])
                                                                            scan date_dim
                                                            partial aggregation over ()
                                                                join (INNER, REPLICATED):
                                                                    dynamic filter (await [ws_sold_date_sk_411::bigint])
                                                                        scan web_sales
                                                                    local exchange (GATHER, SINGLE, [])
                                                                        remote exchange (REPLICATE, BROADCAST, [])
                                                                            scan date_dim
                                    cross join:
                                        final aggregation over (i_brand_id_495, i_category_id_499, i_class_id_497)
                                            local exchange (GATHER, SINGLE, [])
                                                remote exchange (REPARTITION, HASH, [i_brand_id_495, i_category_id_499, i_class_id_497])
                                                    intermediate aggregation over (i_brand_id_495, i_category_id_499, i_class_id_497)
                                                        join (INNER, REPLICATED):
                                                            partial aggregation over (cs_item_sk_464)
                                                                join (INNER, REPLICATED):
                                                                    dynamic filter ([cs_item_sk_464::bigint], await [cs_sold_date_sk_483::bigint])
                                                                        scan catalog_sales
                                                                    local exchange (GATHER, SINGLE, [])
                                                                        remote exchange (REPLICATE, BROADCAST, [])
                                                                            scan date_dim
                                                            local exchange (GATHER, SINGLE, [])
                                                                remote exchange (REPLICATE, BROADCAST, [])
                                                                    join (INNER, PARTITIONED):
                                                                        remote exchange (REPARTITION, HASH, [i_item_sk_488])
                                                                            dynamic filter ([i_item_sk_488::bigint])
                                                                                scan item
                                                                        final aggregation over (i_item_sk_546)
                                                                            local exchange (GATHER, SINGLE, [])
                                                                                remote exchange (REPARTITION, HASH, [i_item_sk_546])
                                                                                    partial aggregation over (i_item_sk_546)
                                                                                        join (INNER, PARTITIONED, can skip output duplicates):
                                                                                            remote exchange (REPARTITION, HASH, [i_brand_id_553, i_category_id_557, i_class_id_555])
                                                                                                dynamic filter ([i_brand_id_553::integer, i_category_id_557::integer, i_class_id_555::integer])
                                                                                                    scan item
                                                                                            final aggregation over (brand_id_571, category_id_573, class_id_572)
                                                                                                local exchange (GATHER, SINGLE, [])
                                                                                                    remote exchange (REPARTITION, HASH, [i_brand_id_611, i_category_id_615, i_class_id_613])
                                                                                                        intermediate aggregation over (i_brand_id_611, i_category_id_615, i_class_id_613)
                                                                                                            join (INNER, REPLICATED):
                                                                                                                partial aggregation over (ss_item_sk_578)
                                                                                                                    join (INNER, REPLICATED):
                                                                                                                        dynamic filter ([ss_item_sk_578::bigint], await [ss_sold_date_sk_599::bigint])
                                                                                                                            scan store_sales
                                                                                                                        local exchange (GATHER, SINGLE, [])
                                                                                                                            remote exchange (REPLICATE, BROADCAST, [])
                                                                                                                                scan date_dim
                                                                                                                local exchange (GATHER, SINGLE, [])
                                                                                                                    remote exchange (REPLICATE, BROADCAST, [])
                                                                                                                        scan item
                                                                                                    remote exchange (REPARTITION, HASH, [i_brand_id_705, i_category_id_709, i_class_id_707])
                                                                                                        intermediate aggregation over (i_brand_id_705, i_category_id_709, i_class_id_707)
                                                                                                            join (INNER, REPLICATED):
                                                                                                                partial aggregation over (cs_item_sk_674)
                                                                                                                    join (INNER, REPLICATED):
                                                                                                                        dynamic filter ([cs_item_sk_674::bigint], await [cs_sold_date_sk_693::bigint])
                                                                                                                            scan catalog_sales
                                                                                                                        local exchange (GATHER, SINGLE, [])
                                                                                                                            remote exchange (REPLICATE, BROADCAST, [])
                                                                                                                                scan date_dim
                                                                                                                local exchange (GATHER, SINGLE, [])
                                                                                                                    remote exchange (REPLICATE, BROADCAST, [])
                                                                                                                        scan item
                                                                                                    remote exchange (REPARTITION, HASH, [i_brand_id_799, i_category_id_803, i_class_id_801])
                                                                                                        intermediate aggregation over (i_brand_id_799, i_category_id_803, i_class_id_801)
                                                                                                            join (INNER, REPLICATED):
                                                                                                                partial aggregation over (ws_item_sk_756)
                                                                                                                    join (INNER, REPLICATED):
                                                                                                                        dynamic filter ([ws_item_sk_756::bigint], await [ws_sold_date_sk_787::bigint])
                                                                                                                            scan web_sales
                                                                                                                        local exchange (GATHER, SINGLE, [])
                                                                                                                            remote exchange (REPLICATE, BROADCAST, [])
                                                                                                                                scan date_dim
                                                                                                                local exchange (GATHER, SINGLE, [])
                                                                                                                    remote exchange (REPLICATE, BROADCAST, [])
                                                                                                                        scan item
                                        local exchange (GATHER, SINGLE, [])
                                            remote exchange (REPLICATE, BROADCAST, [])
                                                final aggregation over ()
                                                    local exchange (GATHER, SINGLE, [])
                                                        remote exchange (GATHER, SINGLE, [])
                                                            partial aggregation over ()
                                                                join (INNER, REPLICATED):
                                                                    dynamic filter (await [ss_sold_date_sk_879::bigint])
                                                                        scan store_sales
                                                                    local exchange (GATHER, SINGLE, [])
                                                                        remote exchange (REPLICATE, BROADCAST, [])
                                                                            scan date_dim
                                                            partial aggregation over ()
                                                                join (INNER, REPLICATED):
                                                                    dynamic filter (await [cs_sold_date_sk_948::bigint])
                                                                        scan catalog_sales
                                                                    local exchange (GATHER, SINGLE, [])
                                                                        remote exchange (REPLICATE, BROADCAST, [])
                                                                            scan date_dim
                                                            partial aggregation over ()
                                                                join (INNER, REPLICATED):
                                                                    dynamic filter (await [ws_sold_date_sk_1017::bigint])
                                                                        scan web_sales
                                                                    local exchange (GATHER, SINGLE, [])
                                                                        remote exchange (REPLICATE, BROADCAST, [])
                                                                            scan date_dim
                                    cross join:
                                        final aggregation over (i_brand_id_1101, i_category_id_1105, i_class_id_1103)
                                            local exchange (GATHER, SINGLE, [])
                                                remote exchange (REPARTITION, HASH, [i_brand_id_1101, i_category_id_1105, i_class_id_1103])
                                                    intermediate aggregation over (i_brand_id_1101, i_category_id_1105, i_class_id_1103)
                                                        join (INNER, PARTITIONED):
                                                            partial aggregation over (ws_item_sk_1058)
                                                                remote exchange (REPARTITION, HASH, [ws_item_sk_1058])
                                                                    join (INNER, REPLICATED):
                                                                        dynamic filter ([ws_item_sk_1058::bigint], await [ws_sold_date_sk_1089::bigint])
                                                                            scan web_sales
                                                                        local exchange (GATHER, SINGLE, [])
                                                                            remote exchange (REPLICATE, BROADCAST, [])
                                                                                scan date_dim
                                                            local exchange (GATHER, SINGLE, [])
                                                                join (INNER, PARTITIONED):
                                                                    remote exchange (REPARTITION, HASH, [i_item_sk_1094])
                                                                        dynamic filter ([i_item_sk_1094::bigint])
                                                                            scan item
                                                                    final aggregation over (i_item_sk_1152)
                                                                        local exchange (GATHER, SINGLE, [])
                                                                            remote exchange (REPARTITION, HASH, [i_item_sk_1152])
                                                                                partial aggregation over (i_item_sk_1152)
                                                                                    join (INNER, PARTITIONED, can skip output duplicates):
                                                                                        remote exchange (REPARTITION, HASH, [i_brand_id_1159, i_category_id_1163, i_class_id_1161])
                                                                                            dynamic filter ([i_brand_id_1159::integer, i_category_id_1163::integer, i_class_id_1161::integer])
                                                                                                scan item
                                                                                        final aggregation over (brand_id_1177, category_id_1179, class_id_1178)
                                                                                            local exchange (GATHER, SINGLE, [])
                                                                                                remote exchange (REPARTITION, HASH, [i_brand_id_1217, i_category_id_1221, i_class_id_1219])
                                                                                                    intermediate aggregation over (i_brand_id_1217, i_category_id_1221, i_class_id_1219)
                                                                                                        join (INNER, REPLICATED):
                                                                                                            partial aggregation over (ss_item_sk_1184)
                                                                                                                join (INNER, REPLICATED):
                                                                                                                    dynamic filter ([ss_item_sk_1184::bigint], await [ss_sold_date_sk_1205::bigint])
                                                                                                                        scan store_sales
                                                                                                                    local exchange (GATHER, SINGLE, [])
                                                                                                                        remote exchange (REPLICATE, BROADCAST, [])
                                                                                                                            scan date_dim
                                                                                                            local exchange (GATHER, SINGLE, [])
                                                                                                                remote exchange (REPLICATE, BROADCAST, [])
                                                                                                                    scan item
                                                                                                remote exchange (REPARTITION, HASH, [i_brand_id_1311, i_category_id_1315, i_class_id_1313])
                                                                                                    intermediate aggregation over (i_brand_id_1311, i_category_id_1315, i_class_id_1313)
                                                                                                        join (INNER, REPLICATED):
                                                                                                            partial aggregation over (cs_item_sk_1280)
                                                                                                                join (INNER, REPLICATED):
                                                                                                                    dynamic filter ([cs_item_sk_1280::bigint], await [cs_sold_date_sk_1299::bigint])
                                                                                                                        scan catalog_sales
                                                                                                                    local exchange (GATHER, SINGLE, [])
                                                                                                                        remote exchange (REPLICATE, BROADCAST, [])
                                                                                                                            scan date_dim
                                                                                                            local exchange (GATHER, SINGLE, [])
                                                                                                                remote exchange (REPLICATE, BROADCAST, [])
                                                                                                                    scan item
                                                                                                remote exchange (REPARTITION, HASH, [i_brand_id_1405, i_category_id_1409, i_class_id_1407])
                                                                                                    intermediate aggregation over (i_brand_id_1405, i_category_id_1409, i_class_id_1407)
                                                                                                        join (INNER, REPLICATED):
                                                                                                            partial aggregation over (ws_item_sk_1362)
                                                                                                                join (INNER, REPLICATED):
                                                                                                                    dynamic filter ([ws_item_sk_1362::bigint], await [ws_sold_date_sk_1393::bigint])
                                                                                                                        scan web_sales
                                                                                                                    local exchange (GATHER, SINGLE, [])
                                                                                                                        remote exchange (REPLICATE, BROADCAST, [])
                                                                                                                            scan date_dim
                                                                                                            local exchange (GATHER, SINGLE, [])
                                                                                                                remote exchange (REPLICATE, BROADCAST, [])
                                                                                                                    scan item
                                        local exchange (GATHER, SINGLE, [])
                                            remote exchange (REPLICATE, BROADCAST, [])
                                                final aggregation over ()
                                                    local exchange (GATHER, SINGLE, [])
                                                        remote exchange (GATHER, SINGLE, [])
                                                            partial aggregation over ()
                                                                join (INNER, REPLICATED):
                                                                    dynamic filter (await [ss_sold_date_sk_1485::bigint])
                                                                        scan store_sales
                                                                    local exchange (GATHER, SINGLE, [])
                                                                        remote exchange (REPLICATE, BROADCAST, [])
                                                                            scan date_dim
                                                            partial aggregation over ()
                                                                join (INNER, REPLICATED):
                                                                    dynamic filter (await [cs_sold_date_sk_1554::bigint])
                                                                        scan catalog_sales
                                                                    local exchange (GATHER, SINGLE, [])
                                                                        remote exchange (REPLICATE, BROADCAST, [])
                                                                            scan date_dim
                                                            partial aggregation over ()
                                                                join (INNER, REPLICATED):
                                                                    dynamic filter (await [ws_sold_date_sk_1623::bigint])
                                                                        scan web_sales
                                                                    local exchange (GATHER, SINGLE, [])
                                                                        remote exchange (REPLICATE, BROADCAST, [])
                                                                            scan date_dim
