local exchange (GATHER, SINGLE, [])
    remote exchange (GATHER, SINGLE, [])
        local exchange (GATHER, SINGLE, [])
            local exchange (REPARTITION, ROUND_ROBIN, [])
                final aggregation over (channel_gid, groupid, i_brand_id_gid, i_category_id_gid, i_class_id_gid)
                    local exchange (REPARTITION, HASH, [channel_gid, groupid, i_brand_id_gid, i_category_id_gid, i_class_id_gid])
                        remote exchange (REPARTITION, HASH, [channel_gid, groupid, i_brand_id_gid, i_category_id_gid, i_class_id_gid])
                            partial aggregation over (channel_gid, groupid, i_brand_id_gid, i_category_id_gid, i_class_id_gid)
                                local exchange (REPARTITION, ROUND_ROBIN, [])
                                    cross join:
                                        final aggregation over (i_brand_id_6, i_category_id_8, i_class_id_7)
                                            local exchange (GATHER, SINGLE, [])
                                                remote exchange (REPARTITION, HASH, [i_brand_id_6, i_category_id_8, i_class_id_7])
                                                    partial aggregation over (i_brand_id_6, i_category_id_8, i_class_id_7)
                                                        join (INNER, PARTITIONED):
                                                            remote exchange (REPARTITION, HASH, [ss_item_sk])
                                                                join (INNER, REPLICATED):
                                                                    join (INNER, REPLICATED):
                                                                        dynamic filter ([Reference[type=bigint, name=ss_item_sk], Reference[type=bigint, name=ss_item_sk]], await [Reference[type=bigint, name=ss_sold_date_sk]])
                                                                            scan store_sales
                                                                        local exchange (GATHER, SINGLE, [])
                                                                            remote exchange (REPLICATE, BROADCAST, [])
                                                                                dynamic filter ([Reference[type=bigint, name=i_item_sk]])
                                                                                    scan item
                                                                    local exchange (GATHER, SINGLE, [])
                                                                        remote exchange (REPLICATE, BROADCAST, [])
                                                                            scan date_dim
                                                            final aggregation over (i_item_sk_13)
                                                                local exchange (GATHER, SINGLE, [])
                                                                    remote exchange (REPARTITION, HASH, [i_item_sk_13])
                                                                        partial aggregation over (i_item_sk_13)
                                                                            join (INNER, PARTITIONED, can skip output duplicates):
                                                                                final aggregation over (brand_id, category_id, class_id)
                                                                                    local exchange (REPARTITION, HASH, [brand_id, category_id, class_id])
                                                                                        remote exchange (REPARTITION, HASH, [i_brand_id_72, i_category_id_76, i_class_id_74])
                                                                                            partial aggregation over (i_brand_id_72, i_category_id_76, i_class_id_74)
                                                                                                join (INNER, REPLICATED):
                                                                                                    join (INNER, REPLICATED):
                                                                                                        dynamic filter ([Reference[type=bigint, name=ss_item_sk_41]], await [Reference[type=bigint, name=ss_sold_date_sk_62]])
                                                                                                            scan store_sales
                                                                                                        local exchange (GATHER, SINGLE, [])
                                                                                                            remote exchange (REPLICATE, BROADCAST, [])
                                                                                                                dynamic filter ([Reference[type=integer, name=i_brand_id_72], Reference[type=integer, name=i_category_id_76], Reference[type=integer, name=i_class_id_74]])
                                                                                                                    scan item
                                                                                                    local exchange (GATHER, SINGLE, [])
                                                                                                        remote exchange (REPLICATE, BROADCAST, [])
                                                                                                            scan date_dim
                                                                                        remote exchange (REPARTITION, HASH, [i_brand_id_128, i_category_id_132, i_class_id_130])
                                                                                            partial aggregation over (i_brand_id_128, i_category_id_132, i_class_id_130)
                                                                                                join (INNER, REPLICATED):
                                                                                                    join (INNER, REPLICATED):
                                                                                                        dynamic filter ([Reference[type=bigint, name=cs_item_sk]], await [Reference[type=bigint, name=cs_sold_date_sk]])
                                                                                                            scan catalog_sales
                                                                                                        local exchange (GATHER, SINGLE, [])
                                                                                                            remote exchange (REPLICATE, BROADCAST, [])
                                                                                                                dynamic filter ([Reference[type=integer, name=i_brand_id_128], Reference[type=integer, name=i_category_id_132], Reference[type=integer, name=i_class_id_130]])
                                                                                                                    scan item
                                                                                                    local exchange (GATHER, SINGLE, [])
                                                                                                        remote exchange (REPLICATE, BROADCAST, [])
                                                                                                            scan date_dim
                                                                                        remote exchange (REPARTITION, HASH, [i_brand_id_184, i_category_id_188, i_class_id_186])
                                                                                            partial aggregation over (i_brand_id_184, i_category_id_188, i_class_id_186)
                                                                                                join (INNER, REPLICATED):
                                                                                                    join (INNER, REPLICATED):
                                                                                                        dynamic filter ([Reference[type=bigint, name=ws_item_sk]], await [Reference[type=bigint, name=ws_sold_date_sk]])
                                                                                                            scan web_sales
                                                                                                        local exchange (GATHER, SINGLE, [])
                                                                                                            remote exchange (REPLICATE, BROADCAST, [])
                                                                                                                dynamic filter ([Reference[type=integer, name=i_brand_id_184], Reference[type=integer, name=i_category_id_188], Reference[type=integer, name=i_class_id_186]])
                                                                                                                    scan item
                                                                                                    local exchange (GATHER, SINGLE, [])
                                                                                                        remote exchange (REPLICATE, BROADCAST, [])
                                                                                                            scan date_dim
                                                                                local exchange (GATHER, SINGLE, [])
                                                                                    remote exchange (REPARTITION, HASH, [i_brand_id_20, i_category_id_24, i_class_id_22])
                                                                                        scan item
                                        local exchange (GATHER, SINGLE, [])
                                            remote exchange (REPLICATE, BROADCAST, [])
                                                final aggregation over ()
                                                    local exchange (GATHER, SINGLE, [])
                                                        remote exchange (GATHER, SINGLE, [])
                                                            partial aggregation over ()
                                                                join (INNER, REPLICATED):
                                                                    dynamic filter (await [Reference[type=bigint, name=ss_sold_date_sk_258]])
                                                                        scan store_sales
                                                                    local exchange (GATHER, SINGLE, [])
                                                                        remote exchange (REPLICATE, BROADCAST, [])
                                                                            scan date_dim
                                                            partial aggregation over ()
                                                                join (INNER, REPLICATED):
                                                                    dynamic filter (await [Reference[type=bigint, name=cs_sold_date_sk_324]])
                                                                        scan catalog_sales
                                                                    local exchange (GATHER, SINGLE, [])
                                                                        remote exchange (REPLICATE, BROADCAST, [])
                                                                            scan date_dim
                                                            partial aggregation over ()
                                                                join (INNER, REPLICATED):
                                                                    dynamic filter (await [Reference[type=bigint, name=ws_sold_date_sk_390]])
                                                                        scan web_sales
                                                                    local exchange (GATHER, SINGLE, [])
                                                                        remote exchange (REPLICATE, BROADCAST, [])
                                                                            scan date_dim
                                    cross join:
                                        final aggregation over (i_brand_id_469, i_category_id_473, i_class_id_471)
                                            local exchange (GATHER, SINGLE, [])
                                                remote exchange (REPARTITION, HASH, [i_brand_id_469, i_category_id_473, i_class_id_471])
                                                    partial aggregation over (i_brand_id_469, i_category_id_473, i_class_id_471)
                                                        join (INNER, PARTITIONED):
                                                            remote exchange (REPARTITION, HASH, [cs_item_sk_440])
                                                                join (INNER, REPLICATED):
                                                                    join (INNER, REPLICATED):
                                                                        dynamic filter ([Reference[type=bigint, name=cs_item_sk_440], Reference[type=bigint, name=cs_item_sk_440]], await [Reference[type=bigint, name=cs_sold_date_sk_459]])
                                                                            scan catalog_sales
                                                                        local exchange (GATHER, SINGLE, [])
                                                                            remote exchange (REPLICATE, BROADCAST, [])
                                                                                dynamic filter ([Reference[type=bigint, name=i_item_sk_462]])
                                                                                    scan item
                                                                    local exchange (GATHER, SINGLE, [])
                                                                        remote exchange (REPLICATE, BROADCAST, [])
                                                                            scan date_dim
                                                            final aggregation over (i_item_sk_518)
                                                                local exchange (GATHER, SINGLE, [])
                                                                    remote exchange (REPARTITION, HASH, [i_item_sk_518])
                                                                        partial aggregation over (i_item_sk_518)
                                                                            join (INNER, PARTITIONED, can skip output duplicates):
                                                                                final aggregation over (brand_id_542, category_id_544, class_id_543)
                                                                                    local exchange (REPARTITION, HASH, [brand_id_542, category_id_544, class_id_543])
                                                                                        remote exchange (REPARTITION, HASH, [i_brand_id_580, i_category_id_584, i_class_id_582])
                                                                                            partial aggregation over (i_brand_id_580, i_category_id_584, i_class_id_582)
                                                                                                join (INNER, REPLICATED):
                                                                                                    join (INNER, REPLICATED):
                                                                                                        dynamic filter ([Reference[type=bigint, name=ss_item_sk_549]], await [Reference[type=bigint, name=ss_sold_date_sk_570]])
                                                                                                            scan store_sales
                                                                                                        local exchange (GATHER, SINGLE, [])
                                                                                                            remote exchange (REPLICATE, BROADCAST, [])
                                                                                                                dynamic filter ([Reference[type=integer, name=i_brand_id_580], Reference[type=integer, name=i_category_id_584], Reference[type=integer, name=i_class_id_582]])
                                                                                                                    scan item
                                                                                                    local exchange (GATHER, SINGLE, [])
                                                                                                        remote exchange (REPLICATE, BROADCAST, [])
                                                                                                            scan date_dim
                                                                                        remote exchange (REPARTITION, HASH, [i_brand_id_670, i_category_id_674, i_class_id_672])
                                                                                            partial aggregation over (i_brand_id_670, i_category_id_674, i_class_id_672)
                                                                                                join (INNER, REPLICATED):
                                                                                                    join (INNER, REPLICATED):
                                                                                                        dynamic filter ([Reference[type=bigint, name=cs_item_sk_641]], await [Reference[type=bigint, name=cs_sold_date_sk_660]])
                                                                                                            scan catalog_sales
                                                                                                        local exchange (GATHER, SINGLE, [])
                                                                                                            remote exchange (REPLICATE, BROADCAST, [])
                                                                                                                dynamic filter ([Reference[type=integer, name=i_brand_id_670], Reference[type=integer, name=i_category_id_674], Reference[type=integer, name=i_class_id_672]])
                                                                                                                    scan item
                                                                                                    local exchange (GATHER, SINGLE, [])
                                                                                                        remote exchange (REPLICATE, BROADCAST, [])
                                                                                                            scan date_dim
                                                                                        remote exchange (REPARTITION, HASH, [i_brand_id_760, i_category_id_764, i_class_id_762])
                                                                                            partial aggregation over (i_brand_id_760, i_category_id_764, i_class_id_762)
                                                                                                join (INNER, REPLICATED):
                                                                                                    join (INNER, REPLICATED):
                                                                                                        dynamic filter ([Reference[type=bigint, name=ws_item_sk_719]], await [Reference[type=bigint, name=ws_sold_date_sk_750]])
                                                                                                            scan web_sales
                                                                                                        local exchange (GATHER, SINGLE, [])
                                                                                                            remote exchange (REPLICATE, BROADCAST, [])
                                                                                                                dynamic filter ([Reference[type=integer, name=i_brand_id_760], Reference[type=integer, name=i_category_id_764], Reference[type=integer, name=i_class_id_762]])
                                                                                                                    scan item
                                                                                                    local exchange (GATHER, SINGLE, [])
                                                                                                        remote exchange (REPLICATE, BROADCAST, [])
                                                                                                            scan date_dim
                                                                                local exchange (GATHER, SINGLE, [])
                                                                                    remote exchange (REPARTITION, HASH, [i_brand_id_525, i_category_id_529, i_class_id_527])
                                                                                        scan item
                                        local exchange (GATHER, SINGLE, [])
                                            remote exchange (REPLICATE, BROADCAST, [])
                                                final aggregation over ()
                                                    local exchange (GATHER, SINGLE, [])
                                                        remote exchange (GATHER, SINGLE, [])
                                                            partial aggregation over ()
                                                                join (INNER, REPLICATED):
                                                                    dynamic filter (await [Reference[type=bigint, name=ss_sold_date_sk_838]])
                                                                        scan store_sales
                                                                    local exchange (GATHER, SINGLE, [])
                                                                        remote exchange (REPLICATE, BROADCAST, [])
                                                                            scan date_dim
                                                            partial aggregation over ()
                                                                join (INNER, REPLICATED):
                                                                    dynamic filter (await [Reference[type=bigint, name=cs_sold_date_sk_904]])
                                                                        scan catalog_sales
                                                                    local exchange (GATHER, SINGLE, [])
                                                                        remote exchange (REPLICATE, BROADCAST, [])
                                                                            scan date_dim
                                                            partial aggregation over ()
                                                                join (INNER, REPLICATED):
                                                                    dynamic filter (await [Reference[type=bigint, name=ws_sold_date_sk_970]])
                                                                        scan web_sales
                                                                    local exchange (GATHER, SINGLE, [])
                                                                        remote exchange (REPLICATE, BROADCAST, [])
                                                                            scan date_dim
                                    cross join:
                                        final aggregation over (i_brand_id_1049, i_category_id_1053, i_class_id_1051)
                                            local exchange (GATHER, SINGLE, [])
                                                remote exchange (REPARTITION, HASH, [i_brand_id_1049, i_category_id_1053, i_class_id_1051])
                                                    partial aggregation over (i_brand_id_1049, i_category_id_1053, i_class_id_1051)
                                                        join (INNER, PARTITIONED):
                                                            remote exchange (REPARTITION, HASH, [ws_item_sk_1008])
                                                                join (INNER, REPLICATED):
                                                                    join (INNER, REPLICATED):
                                                                        dynamic filter ([Reference[type=bigint, name=ws_item_sk_1008], Reference[type=bigint, name=ws_item_sk_1008]], await [Reference[type=bigint, name=ws_sold_date_sk_1039]])
                                                                            scan web_sales
                                                                        local exchange (GATHER, SINGLE, [])
                                                                            remote exchange (REPLICATE, BROADCAST, [])
                                                                                dynamic filter ([Reference[type=bigint, name=i_item_sk_1042]])
                                                                                    scan item
                                                                    local exchange (GATHER, SINGLE, [])
                                                                        remote exchange (REPLICATE, BROADCAST, [])
                                                                            scan date_dim
                                                            final aggregation over (i_item_sk_1098)
                                                                local exchange (GATHER, SINGLE, [])
                                                                    remote exchange (REPARTITION, HASH, [i_item_sk_1098])
                                                                        partial aggregation over (i_item_sk_1098)
                                                                            join (INNER, PARTITIONED, can skip output duplicates):
                                                                                final aggregation over (brand_id_1122, category_id_1124, class_id_1123)
                                                                                    local exchange (REPARTITION, HASH, [brand_id_1122, category_id_1124, class_id_1123])
                                                                                        remote exchange (REPARTITION, HASH, [i_brand_id_1160, i_category_id_1164, i_class_id_1162])
                                                                                            partial aggregation over (i_brand_id_1160, i_category_id_1164, i_class_id_1162)
                                                                                                join (INNER, REPLICATED):
                                                                                                    join (INNER, REPLICATED):
                                                                                                        dynamic filter ([Reference[type=bigint, name=ss_item_sk_1129]], await [Reference[type=bigint, name=ss_sold_date_sk_1150]])
                                                                                                            scan store_sales
                                                                                                        local exchange (GATHER, SINGLE, [])
                                                                                                            remote exchange (REPLICATE, BROADCAST, [])
                                                                                                                dynamic filter ([Reference[type=integer, name=i_brand_id_1160], Reference[type=integer, name=i_category_id_1164], Reference[type=integer, name=i_class_id_1162]])
                                                                                                                    scan item
                                                                                                    local exchange (GATHER, SINGLE, [])
                                                                                                        remote exchange (REPLICATE, BROADCAST, [])
                                                                                                            scan date_dim
                                                                                        remote exchange (REPARTITION, HASH, [i_brand_id_1250, i_category_id_1254, i_class_id_1252])
                                                                                            partial aggregation over (i_brand_id_1250, i_category_id_1254, i_class_id_1252)
                                                                                                join (INNER, REPLICATED):
                                                                                                    join (INNER, REPLICATED):
                                                                                                        dynamic filter ([Reference[type=bigint, name=cs_item_sk_1221]], await [Reference[type=bigint, name=cs_sold_date_sk_1240]])
                                                                                                            scan catalog_sales
                                                                                                        local exchange (GATHER, SINGLE, [])
                                                                                                            remote exchange (REPLICATE, BROADCAST, [])
                                                                                                                dynamic filter ([Reference[type=integer, name=i_brand_id_1250], Reference[type=integer, name=i_category_id_1254], Reference[type=integer, name=i_class_id_1252]])
                                                                                                                    scan item
                                                                                                    local exchange (GATHER, SINGLE, [])
                                                                                                        remote exchange (REPLICATE, BROADCAST, [])
                                                                                                            scan date_dim
                                                                                        remote exchange (REPARTITION, HASH, [i_brand_id_1340, i_category_id_1344, i_class_id_1342])
                                                                                            partial aggregation over (i_brand_id_1340, i_category_id_1344, i_class_id_1342)
                                                                                                join (INNER, REPLICATED):
                                                                                                    join (INNER, REPLICATED):
                                                                                                        dynamic filter ([Reference[type=bigint, name=ws_item_sk_1299]], await [Reference[type=bigint, name=ws_sold_date_sk_1330]])
                                                                                                            scan web_sales
                                                                                                        local exchange (GATHER, SINGLE, [])
                                                                                                            remote exchange (REPLICATE, BROADCAST, [])
                                                                                                                dynamic filter ([Reference[type=integer, name=i_brand_id_1340], Reference[type=integer, name=i_category_id_1344], Reference[type=integer, name=i_class_id_1342]])
                                                                                                                    scan item
                                                                                                    local exchange (GATHER, SINGLE, [])
                                                                                                        remote exchange (REPLICATE, BROADCAST, [])
                                                                                                            scan date_dim
                                                                                local exchange (GATHER, SINGLE, [])
                                                                                    remote exchange (REPARTITION, HASH, [i_brand_id_1105, i_category_id_1109, i_class_id_1107])
                                                                                        scan item
                                        local exchange (GATHER, SINGLE, [])
                                            remote exchange (REPLICATE, BROADCAST, [])
                                                final aggregation over ()
                                                    local exchange (GATHER, SINGLE, [])
                                                        remote exchange (GATHER, SINGLE, [])
                                                            partial aggregation over ()
                                                                join (INNER, REPLICATED):
                                                                    dynamic filter (await [Reference[type=bigint, name=ss_sold_date_sk_1418]])
                                                                        scan store_sales
                                                                    local exchange (GATHER, SINGLE, [])
                                                                        remote exchange (REPLICATE, BROADCAST, [])
                                                                            scan date_dim
                                                            partial aggregation over ()
                                                                join (INNER, REPLICATED):
                                                                    dynamic filter (await [Reference[type=bigint, name=cs_sold_date_sk_1484]])
                                                                        scan catalog_sales
                                                                    local exchange (GATHER, SINGLE, [])
                                                                        remote exchange (REPLICATE, BROADCAST, [])
                                                                            scan date_dim
                                                            partial aggregation over ()
                                                                join (INNER, REPLICATED):
                                                                    dynamic filter (await [Reference[type=bigint, name=ws_sold_date_sk_1550]])
                                                                        scan web_sales
                                                                    local exchange (GATHER, SINGLE, [])
                                                                        remote exchange (REPLICATE, BROADCAST, [])
                                                                            scan date_dim
